(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3363:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(5155);let s=e=>{let{categoryParam:t,handleCategoryParam:r,categories:s}=e;return(0,a.jsx)("div",{children:(0,a.jsxs)("select",{name:"sort",id:"sort",value:null!=t?t:"",className:"border border-[#c4c4c4] rounded-md p-2 h-10",onChange:e=>r(e.target.value?Number(e.target.value):null),children:[(0,a.jsx)("option",{value:"",children:"All"}),null==s?void 0:s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})})};var o=r(2115),c=r(5125),l=r(2544);let d=e=>{let{todosHandler:t,categoryParam:r,categories:s}=e,[d,n]=(0,o.useState)(!1),{register:i,handleSubmit:m,reset:x,formState:{errors:u}}=(0,l.mN)({defaultValues:{name:"",categoryId:""}}),p=async e=>{let a={name:e.name.trim(),categoryId:e.categoryId?Number(e.categoryId):null};try{let e=(await c.A.post("".concat("https://todo-app-2-1qr7.onrender.com","/todos/"),a)).data;r&&e.categoryId!==r||t(t=>[...t,e]),n(!1),x()}catch(e){if(c.A.isAxiosError(e)){var s,o,l;(null==(o=e.response)||null==(s=o.data)?void 0:s.message)==="A category may contain at most 5 tasks"&&n(!0),console.error("Axios error adding todo:",(null==(l=e.response)?void 0:l.data)||e.message)}else console.error("Unknown error adding todo:",e)}};return(0,a.jsx)("div",{children:(0,a.jsxs)("form",{onSubmit:m(p),className:"flex items-start space-x-3",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("input",{type:"text",placeholder:"Do something great...",className:"border border-[#c4c4c4] rounded-md p-2 h-10",...i("name",{required:"Todo name is required",minLength:{value:3,message:"Name must be at least 3 characters"}})}),u.name&&(0,a.jsx)("p",{className:"text-red-400 text-[0.8rem] mt-1",children:u.name.message})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("select",{...i("categoryId",{required:"Please select a category"}),className:"border border-[#c4c4c4] rounded-md p-2 h-10",children:[(0,a.jsx)("option",{value:"",disabled:!0,children:"Select a category"}),null==s?void 0:s.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]}),u.categoryId&&(0,a.jsx)("p",{className:"text-red-400 text-[0.8rem] mt-1",children:u.categoryId.message}),d&&(0,a.jsx)("p",{className:"text-red-400 text-[0.8rem] mt-1",children:"A category may contain at most 5 tasks"})]}),(0,a.jsx)("button",{type:"submit",className:"border border-[#c4c4c4] p-2 h-10 rounded-xl duration-200 hover:scale-[1.05] cursor-pointer",children:"Add"})]})})},n=e=>{let{todosHandler:t,categoryParam:r,handleCategoryParam:o,categories:c}=e;return(0,a.jsxs)("div",{className:"flex text-[#818181] gap-5 text-xl mb-3",children:[(0,a.jsx)(s,{categoryParam:r,handleCategoryParam:o,categories:c}),(0,a.jsx)(d,{todosHandler:t,categoryParam:r,categories:c})]})};var i=r(4233),m=r(898),x=r(2663);let u=e=>{var t;let{id:r,name:s,status:o,categoryId:l,todoHandler:d,categories:n}=e,u=(null==(t=n.find(e=>e.id===l))?void 0:t.name)||"No category",p=async()=>{try{await c.A.patch("".concat("https://todo-app-2-1qr7.onrender.com","/todos/").concat(r),{status:"NOTDONE"}),d(e=>e.map(e=>e.id===r?{...e,status:"NOTDONE"}:e)),x.oR.success("Task restored!")}catch(e){console.error("Error while undoing status:",e),x.oR.error("Failed to restore task.")}},h=async()=>{let e="NOTDONE"===o?"DONE":"NOTDONE";try{await c.A.patch("".concat("https://todo-app-2-1qr7.onrender.com","/todos/").concat(r),{status:e}),d(t=>t.map(t=>t.id===r?{...t,status:e}:t)),"DONE"===e&&x.oR.custom(e=>(0,a.jsxs)("div",{className:"".concat(e.visible?"animate-enter":"animate-leave"," bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center justify-between"),children:[(0,a.jsx)("p",{className:"mr-4",children:"Task completed!"}),(0,a.jsx)("button",{onClick:()=>{p(),x.oR.dismiss(e.id)},className:"font-bold text-white cursor-pointer",children:"Undo"})]}),{duration:4e3})}catch(e){console.error("Error while updating status:",e),x.oR.error("Failed to update status.")}},g=async()=>{try{await c.A.delete("".concat("https://todo-app-2-1qr7.onrender.com","/todos/").concat(r)),d(e=>e.filter(e=>e.id!==r)),x.oR.success("Task deleted!")}catch(e){console.error("Error while deleting todo:",e),x.oR.error("Failed to delete task.")}};return(0,a.jsxs)("div",{className:"NOTDONE"===o?"flex mt-4 pb-2 justify-between text-[#818181] border-b-1 text-xl border-[#f3f3f3]":"flex mt-4 pb-2 text-[#c4c4c4] justify-between border-b-1 text-xl border-[#f3f3f3]",children:[(0,a.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,a.jsx)("button",{onClick:h,className:"DONE"===o?"border-1 cursor-pointer p-1 border-[#c4c4c4] rounded-[3px] duration-200 hover:scale-[1.1]":"border-1 text-transparent cursor-pointer p-1 border-[#a3a3a3] rounded-[3px] duration-200 hover:scale-[1.1]",children:(0,a.jsx)(i.J1G,{})}),(0,a.jsx)("p",{children:s})]}),(0,a.jsxs)("div",{className:"flex gap-8 items-center",children:[(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)("p",{className:"NOTDONE"===o?"bg-green-400 text-white px-2":"bg-green-400 text-white px-2 opacity-50",children:u})}),(0,a.jsx)("button",{className:"cursor-pointer duration-200 hover:scale-[1.1]",onClick:g,children:(0,a.jsx)(m.RCe,{})})]})]})};var p=r(7191);let h=()=>{let[e,t]=(0,o.useState)(!0),[r,s]=(0,o.useState)(null),[l,d]=(0,o.useState)([]),[i,m]=(0,o.useState)([]);return(0,o.useEffect)(()=>{(async()=>{try{let e=await c.A.get("".concat("https://todo-app-2-1qr7.onrender.com","/categories"));m(e.data),t(!1)}catch(e){console.error("Failed to fetch categories:",e)}})()},[]),(0,o.useEffect)(()=>{(async()=>{try{let e=await c.A.get("".concat("https://todo-app-2-1qr7.onrender.com","/todos"),{params:{category:r}});d(e.data)}catch(r){if(c.A.isAxiosError(r)){var e,t;console.log("Axios error:",null==(e=r.response)?void 0:e.status,null==(t=r.response)?void 0:t.data)}else console.log("Unexpected error:",r)}})()},[r]),(0,a.jsxs)("main",{className:"font-lato flex justify-center",children:[(0,a.jsx)(x.l$,{position:"bottom-center"}),(0,a.jsxs)("div",{className:"px-20 pt-20 max-w-[1000px]",children:[(0,a.jsx)(n,{categoryParam:r,handleCategoryParam:s,todosHandler:d,categories:i}),(0,a.jsx)("div",{className:"flex flex-col",children:e?(0,a.jsx)("div",{className:"flex items-center justify-center h-[20rem]",children:(0,a.jsx)(p.A,{size:100,color:"#818181"})}):l.length>0?l.slice().sort((e,t)=>e.status===t.status?0:"NOTDONE"===e.status?-1:1).map(e=>(0,a.jsx)(u,{id:e.id,name:e.name,status:e.status,categoryId:e.categoryId,todoHandler:d,categories:i},e.id)):(0,a.jsx)("div",{className:"flex items-center justify-center h-[20rem] text-[#818181]",children:(0,a.jsx)("p",{children:"No tasks!"})})})]})]})}},5738:(e,t,r)=>{Promise.resolve().then(r.bind(r,3363))}},e=>{e.O(0,[206,711,271,441,255,358],()=>e(e.s=5738)),_N_E=e.O()}]);